<!doctype html>
<html>
  <head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Being Rust</title>

	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/brson-theme.css">
	<link rel="stylesheet" href="css/theme/custom-theme.css">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/monokai.css">

	<!-- Custom rules -->
	<link rel="stylesheet" href="css/brson.css">
	<link rel="stylesheet" href="css/custom.css">

	<!-- Printing and PDF exports -->
	<script>
	  var link = document.createElement( 'link' );
	  link.rel = 'stylesheet';
	  link.type = 'text/css';
	  link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
	  document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>
  </head>

  <body id="brson">
	<div class="reveal">

	  <div class="slides">




        <section id="s-title">
          <div class="two-box" "small-big">
            <div>
              <h1>Being Rust</h1>
              <p>
                <a href="https://github.com/brson/being-rust">
                  https://github.com/brson/being-rust
                </a>
              </p>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>

          <aside class="notes">
            TODO
          </aside>
        </section>
        



        <!-- PART X: Session overview -->




        <section id="s-overview">
          <div class="two-box small-big">
            <div>
              <h2>What?</h2>
              <p>
                <a href="https://github.com/brson/being-rust">
                  https://github.com/brson/being-rust
                </a>
              </p>
            </div>
            <div>
              <ul>
                <li>Rust hype
                <li>Memory management
                <li>Rust history
                <li>How I work with Rust
                <li>How to learn Rust
                <li>Beyond tech
                <li>Guru notes
              </ul>
            </div>
          </div>

          <aside class="notes">
            TODO
          </aside>
        </section>


        <section id="s-bonus">
          <div class="two-box small-big">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Also</h3>
              <ul>
                <li>Q&amp;A
                <li>Stories
                <li>Live mistake-making!
              </ul>
            </div>
          </div>
        </section>

        
        <section id="s-wip">
          <div class="img-slide">
            <img src="images/grid.png">
          </div>

          <aside class="notes">
            WIP
          </aside>
        </section>

        <section id="s-me">
          <div class="two-box" "small-big">
            <div>
              <div class="img-box">
                <img src="images/me.jpg">
              </div>
            </div>
            <div>
              <h3>About me (brson)</h3>
              <ul>
                <li>Rust since 2010
                <li>Mozilla / Rust core team
                <li>PingCAP since 2018
                <li>talent-plan/rust
              </ul>
              <a href="https://brson.github.io">brson.github.io</a>
            </div>
          </div>
        </section>

        <section id="s-you">
          <div class="two-box" "big-small">
            <div>
              <h3>About you</h3>
              <ul>
                <li>Self-motivated
                <li>Some programming experience
                <li>Have read The Rust Book
              </ul>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>
        </section>
        
	

        <!-- PART X: Hype! -->




        <section id="s-hype">
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>Hype!</h2>
              </div>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>

          <aside class="notes">
            TODO
          </aside>
        </section>

        <section id="s-pitch">
          <div>
            <h3>Elevator Pitch</h3>
            <p>
              Rust is a programming language that does exactly what you tell it
              to. It is one of the fastest languages in the world, but it does
              not crash like comparable languages. It is suitable for the most
              performance- and safety-critical systems, as well as for daily
              software development, and it runs everywhere.
            </p>
          </div>
        </section>

        <section id="s-features">
          <div>
            <h3>Key features</h3>
            <ul>
              <li><em>Memory safety</em>
              <li>Deterministic memory management
              <li>No runtime (no GC)
              <li>Ownership and borrowing
              <li>Platform support
            </ul>
          </div>
        </section>

        <section id="s-use-cases">
          <div class="title-two-box">
            <div>
              <h3>Rust use cases</h3>
            </div>
            <div>
              <div>
                <ul>
                  <li>CLI tools
                  <li>Operating systems
                  <li>Runtimes
                  <li>Multi-platform
                  <li>Databases
                  <li>Networking
                  <li>Microcontrollers
                </ul>
              </div>
              <div>
                <ul>
                  <li>Firmware
                  <li>Rendering
                  <li>Web backends
                  <li>Web frontends (WASM)
                  <li>Aerospace
                  <li>Blockchains
                  <li>Finance
                </ul>
              </div>
            </div>
          </div>
        </section>

        <section id="users">
          <div>
            <h3>Rust users</h3>
            <div class="image-list">
			  <img src="images/logo-baidu.png" width="1000" height="1000">
			  <img src="images/logo-cloudflare.svg" width="1000" height="1000">
			  <img src="images/logo-dropbox.svg" width="1000" height="1000">
			  <img src="images/logo-facebook.png" width="1000" height="1000">
			  <img src="images/logo-google.png" width="1000" height="1000">
			  <img src="images/logo-microsoft.png" width="1000" height="1000">
			  <img src="images/logo-mozilla.png" width="1000" height="1000">
			  <img src="images/logo-pingcap.png" width="1000" height="1000">
			  <img src="images/logo-yelp.png" width="1000" height="1000">
            </div>
          </div>

          <aside class="notes">

            Next: specific products.<br>
          </aside>
        </section>

        <section id="user-mozilla">
          <div>
            <h3>User: Mozilla</h3>
            <ul>
              <li>Product: Firefox
              <li>What: Web browser
              <li>Why: Security
              <li>Why: Performance
            </ul>
            <p><a href="https://github.com/servo/servo">https://github.com/servo/servo</a></p>
          </div>

          <aside class="notes">
            Anecdote: creating servo with Rust<br>
          </aside>
        </section>
        
        <section id="user-pingcap">
          <div>
            <h3>User: PingCAP</h3>
            <ul>
              <li>Product: TiDB (TiKV)
              <li>What: Database
              <li>Why: Reliability
              <li>Why: Performance
            </ul>
            <p><a href="https://github.com/tikv/tikv">https://github.com/tikv/tikv</a></p>
          </div>
        </section>

        <section id="user-cloudflare">
          <div>
            <h3>User: Cloudflare</h3>
            <ul>
              <li>Product: TiDB (TiKV)
              <li>What: Edge compute sandboxing
              <li>Why: WASM
            </ul>
            <p><a href="https://github.com/cloudflare/quiche">https://github.com/cloudflare/quiche</a></p>
          </div>
        </section>

        <section id="s-quotes">
          <div>
            <h3>Rust quotes and press</h3>
            <p>TODO</p>
            <p><a href="https://github.com/brson/my-rust-lists/blob/master/rust-quotes-and-press.md">
                https://github.com/brson/my-rust-lists/blob/master/rust-quotes-and-press.md
            </a></p>
          </div>
        </section>

        <section>
          <div class="two-box">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Questions?</h3>
            </div>
          </div>
        </section>
        


        <!-- PART X: Memory management -->




        <section>
          <div class="two-box" "big-small">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <div>
                <h2>Memory management</h2>
              </div>
            </div>
          </div>
        </section>

        <section>
          <div>
            <h3>The CPU and RAM</h3>
            <pre>
+---------------+           +---------------+
|               |           |               |
|   I'm the     |           |    I'm the    |
|     CPU       +-----------+      RAM      |
|               |           |               |
|               |     ^     |               |
+---------------+     |     +---------------+
                      |
               (this is slow)
            </pre>
          </div>
        </section>

        <section>
          <div>
            <h3>The CPU and RAM</h3>
            <pre>
5b080  &lt;alloc::box_free&gt;:
5b080: 48 89 f0     mov    %rsi, %rax
5b083: 48 8b 76 08  mov    0x8(%rsi), %rsi
5b087: 48 85 f6     test   %rsi, %rsi
5b08a: 74 0a        je     5b096 &lt;alloc::box_free+0x16&gt;
            </pre>
          </div>
        </section>

        <section>
          <div>
            <div>
              <h3>The callstack</h3>
            </div>
          </div>
        </section>

        <section>
          <div class="two-box">
              <div>
                <h4>Source code</h4>
                <pre>
fn main() {
    let a = 1;
    foo(&a);
}
                </pre>
              </div>
              <div>
                <h4>Stack frames</h4>
                <pre>
|=============| 0x00
| fn main     |
| a = 1       |
|=============|
                </pre>
              </div>
          </div>
        </section>

        <section>
          <div class="two-box">
              <div>
                <h4>Source code</h4>
                <pre>
fn main() {
    let a = 1;
    foo(&a);
}

fn foo(ptr_a: &i32) {
    let b = 2;
    bar(ptr_a, &b);
}
                </pre>
              </div>
              <div>
                <h4>Stack frames</h4>
                <pre>
|=============| 0x00
| fn main     |
| a = 1       |
|=============| 0x10
| fn foo      |
| &lt;main regs&gt; |
| ptr_a = &a  |
| b = 2       |
|=============|
                </pre>
              </div>
          </div>
        </section>

        <section>
          <div class="two-box">
              <div>
                <h4>Source code</h4>
                <pre>
fn foo(ptr_a: &i32) {
    let b = 2;
    bar(ptr_a, &b);
}

fn bar(ptr_a: &i32,
       ptr_b: &i32) {
    ...
}
                </pre>
              </div>
              <div>
                <h4>Stack frames</h4>
                <pre>
 ...
|=============| 0x10
| fn foo      |
| &lt;main regs&gt; |
| ptr_a = &a  |
| b = 2       |
|=============| 0x20
| fn bar      |
| &lt;foo regs&gt;  |
| ptr_a = &a  |
| ptr_b = &b  |
|=============|
                </pre>
              </div>
          </div>
        </section>

        <section>
          <div class="two-box">
              <div>
                <h4>Source code</h4>
                <pre>
fn main() {
    let a = 1;
    foo(&a);
}

fn foo(ptr_a: &i32) {
    let b = 2;
    bar(ptr_a, &b);
}
                </pre>
              </div>
              <div>
                <h4>Stack frames</h4>
                <pre>
|=============| 0x00
| fn main     |
| a = 1       |
|=============| 0x10
| fn foo      |
| &lt;main regs&gt; |
| ptr_a = &a  |
| b = 2       |
|=============|
                </pre>
              </div>
          </div>
        </section>

        <section>
          <div class="two-box">
              <div>
                <h4>Source code</h4>
                <pre>
fn main() {
    let a = 1;
    foo(&a);
}
                </pre>
              </div>
              <div>
                <h4>Stack frames</h4>
                <pre>
|=============| 0x00
| fn main     |
| a = 1       |
|=============|
                </pre>
              </div>
          </div>
        </section>

        <section>
          <div>
            <h3>The heap</h3>
            <ul>
              <li>Not CPU registers
              <li>Not the stack
              <li>All the other RAM
              <li>As allocated with <code>malloc</code>
            </ul>
          </div>

          <aside class="notes">
            TODO diagram<br>

            Most RAM<br>
          </aside>
        </section>

        <section>
          <div class="two-box">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Questions?</h3>
            </div>
          </div>
        </section>

        <section>
          <div>
            <h3>Managing the heap</h3>
            <ul>
              <li>manually with alloc / free (like C)
              <li>garbage collection (like Go)
            </ul>
          </div>
        </section>

        <section>
          <div>
            <h3>Heap management examples</h3>
            <a href="https://github.com/brson/being-rust/blob/master/examples/">https://github.com/brson/being-rust/blob/master/examples/</a>
          </div>

          <aside class="notes">
            Live code examples in C and Go.<br>

            Use valgrind for C.<br>

            stdlib.h string.h stdio.h<br>

            typedef void(*fptr)(void)<br>
          </aside>
        </section>

        <section>
          <div>
            <h3>Problems of malloc/free</h3>
            <ul>
              <li>Use after free
              <li>Double free
              <li>Crashes == security bugs
            </ul>
          </div>
        </section>

        <section>
          <div>
            <h3>Problems of garbage collection</h3>
            <ul>
              <li>Bookeeping overhead
              <li>CPU overhead
              <li>Latency
              <li>Runtime binary
              <li>Mutable aliasing
            </ul>
          </div>
        </section>




        <!-- PART X: Ownership -->



        
        <section id="s-ownership">
          <div class="two-box" "big-small">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <div>
                <h3>Ownership in Rust</h3>
              </div>
            </div>
          </div>

          <aside class="notes">
            Live example.
            
            Anecdote: origins of ownership<br>
          </aside>
        </section>

        <section>
          <div class="two-box">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Questions?</h3>
            </div>
          </div>
        </section>




        <!-- PART X: History -->




        <section id="s-history">
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>Rust history</h2>
              </div>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>

          <aside class="notes">
            TODO
          </aside>
        </section>

        <section>
          <div class="two-box">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Questions?</h3>
            </div>
          </div>
        </section>




        <!-- PART X: How I work with Rust -->




        <section id="s-how-i-work">
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>How I work with Rust</h2>
              </div>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>

          <aside class="notes">
            Live code recursive 'dirsize'
          </aside>
        </section>

        <section>
          <div class="two-box">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Questions?</h3>
            </div>
          </div>
        </section>

        


        <!-- PART X: How to learn Rust -->




        <section id="s-learn">
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>How to learn Rust</h2>
              </div>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>

          <aside class="notes">
            TODO
          </aside>
        </section>

        <section>
          <div>
            <h3>Rust mindset</h3>
            <ul>
              <li>Be curious
              <li>Write real projects
              <li>Read real code
              <li>Try again
              <li>Ask for help
            </ul>
          </div>
        </section>
        
        <section>
          <div>
            <h3>Rust mindset</h3>
            <ul>
              <li>Be curious
              <li>Write real projects
              <li>Read real code
              <li>Try again
              <li>Ask for help
            </ul>
          </div>
        </section>

        <section>
          <div>
            <h3>Rust resources</h3>
            <p>See README.md</p>
          </div>

          <aside class="notes">
            Live resource browsing
          </aside>
        </section>




        <!-- PART X: Beyond tech -->




        <section id="s-beyond">
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>Beyond tech</h2>
              </div>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>
        </section>

        <section>
          <div class="two-box" "big-small">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <div>
                <h2>Relationships</h2>
              </div>
            </div>
          </div>
        </section>

        <section>
          <div class="two-box" "big-small">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <div>
                <h2>Insecurity</h2>
              </div>
            </div>
          </div>
          <aside class="notes">
            Impostor syndrome<br>

            Anecdote: first experience with dherman<br>
          </aside>
        </section>

        <section>
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>Criticism</h2>
              </div>
              <a href="https://brson.github.io/2017/04/05/minimally-nice-maintainer">https://brson.github.io/2017/04/05/minimally-nice-maintainer</a>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>
        </section>

        <section>
          <div class="two-box" "big-small">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <div>
                <h2>Contributing</h2>
              </div>
            </div>
          </div>

          <aside class="notes">
            Anecdote: Getting involved in Rust<br>
          </aside>
        </section>

        <section>
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>Inspiration</h2>
              </div>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>
        </section>

        <section>
          <div class="two-box">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Questions?</h3>
            </div>
          </div>
        </section>
        


        <!-- PART X: Guru notes -->




        <section id="s-guru">
          <div class="two-box" "small-big">
            <div>
              <div>
                <h2>Guru notes</h2>
                <a href="https://github.com/brson/my-rust-lists/blob/master/rust-guru-notes.md">
                  https://github.com/brson/my-rust-lists/blob/master/rust-guru-notes.md
                </a>
              </div>
            </div>
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
          </div>

          <aside class="notes">
            Random.<br>

            Opinionated.<br>

            Maybe wrong.<br>
          </aside>
        </section>

        <section>
          <div>
            <h3>Understand mutable aliasing</h3>
            <p>This is the thing Rust solves.</p>
            <p>See README.md for links</p>
          </div>
        </section>

        <section>
          <div>
            <h3>Don't jump to lifetimes</h3>
            <p>Just clone stuff.</p>
            <ul>
              <li>`memcpy` is fast.
              <li>`malloc` is fast.
            </ul>
          </div>
        </section>

        <section>
          <div>
            <h3>Don't use `#[bench]`</h3>
            <p>Use criterion.</p>

            <p><a href="https://github.com/bheisler/criterion.rs">https://github.com/bheisler/criterion.rs</a></p>
          </div>
        </section>

        <section>
          <div>
            <h3>`impl Drop` is a breaking change</h3>
            <pre>
struct Bar;
struct Foo(Bar);
impl Drop for Foo { fn drop(&mut self) { } }

fn main() {
    // XXX can't destructure
    let Foo(i) = Foo(Bar);
}
            </pre>
          </div>
        </section>

        <section>
          <div>
            <h3>Know the `cargo` command line</h3>
            <p>
              The defaults are not always what you want. Save time
              by being precise with your `cargo` invocations.
            </p>
            <pre>
cargo check --all
cargo test --all --no-run
cargo check --all --no-run --profile=dev
cargo test -p subproject
            </pre>
          </div>
        </section>

        <section>
          <div>
            <h3>The "turbofish"</h3>
            <span class="fish">a::&lt;B&gt;();</span>
          </div>
        </section>

        <section>
          <div>
            <h3>Alternate debug formatting</h3>
            <pre>
println!("{:?}", qux);
println!("{:#?}", qux);
            </pre>
            <hr>
            <pre>
Foo { bar: 0, baz: 1 }
Foo {
    bar: 0,
    baz: 1,
}
            </pre>
          </div>
        </section>

        <section>
          <div>
            <h3>Building without the networking</h3>
            <pre>
cargo generate-lockfile
cargo fetch
cargo build --locked --offline
cargo test --locked --offline
            </pre>
          </div>
        </section>

        <section>
          <div>
            <h3>Rust CI tools</h3>
            <pre>
cargo clippy
cargo fmt
cargo outdated
cargo audit
            </pre>
          </div>
        </section>
        
        <section>
          <div class="two-box">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h3>Questions?</h3>
            </div>
          </div>
        </section>

        
        

        <!-- PART X: Closing -->




        <section id="s-close">
          <div class="img-slide">
            <img src="images/grid.png">
          </div>

          <aside class="notes">
            Closing thoughts
          </aside>
        </section>


        <section id="s-end">
          <div class="two-box" "big-small">
            <div>
              <div class="img-box">
                <img src="images/grid.png">
              </div>
            </div>
            <div>
              <h1>Being Rust</h1>
              <p>
                <a href="https://github.com/brson/being-rust">
                  https://github.com/brson/being-rust
                </a>
              </p>
            </div>
          </div>

          <aside class="notes">
            TODO
          </aside>
        </section>
        



      </div> <!-- class="slides" -->

	</div> <!-- class="reveal" -->

	<script src="js/reveal.js"></script>

	<script>
	  // More info about config & dependencies:
	  // - https://github.com/hakimel/reveal.js#configuration
	  // - https://github.com/hakimel/reveal.js#dependencies
	  Reveal.initialize({
	  history: true,
	  margin: 0,
	  /*width: "100%",
	  height: "100%",*/
	  /*width: 960,
	  height: 700,*/
	  width: 1920,
	  height: 1080,
	  minScale: 0.1,
	  maxScale: 20,
	  dependencies: [
	  { src: 'plugin/markdown/marked.js' },
	  { src: 'plugin/markdown/markdown.js' },
	  { src: 'plugin/notes/notes.js', async: true },
	  { src: 'plugin/highlight/highlight.js', async: true }
	  ]
	  });
	</script>
  </body>
</html>
